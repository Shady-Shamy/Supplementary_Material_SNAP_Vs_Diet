{
  "hash": "2d4b6f92563e251c885be8475f4f33ec",
  "result": {
    "markdown": "---\ntitle: \"Statewide and Pilot 2 Comparison\"\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(error = FALSE,warning = FALSE,message = FALSE,echo = TRUE)\n\nlibrary(gtsummary)\nlibrary(performance)\nlibrary(mice)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'mice'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    cbind, rbind\n```\n:::\n\n```{.r .cell-code}\nlibrary(kableExtra)\nlibrary(dotwhisker)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: ggplot2\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:kableExtra':\n\n    group_rows\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(gridExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'gridExtra'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    combine\n```\n:::\n\n```{.r .cell-code}\nlibrary(grid)\nlibrary(tidymodels)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ broom        1.0.5     ✔ rsample      1.2.0\n✔ dials        1.2.0     ✔ tibble       3.2.1\n✔ infer        1.0.5     ✔ tidyr        1.3.0\n✔ modeldata    1.2.0     ✔ tune         1.1.2\n✔ parsnip      1.1.1     ✔ workflows    1.1.3\n✔ purrr        1.0.2     ✔ workflowsets 1.0.1\n✔ recipes      1.0.8     ✔ yardstick    1.2.0\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ recipes::all_double()  masks gtsummary::all_double()\n✖ recipes::all_factor()  masks gtsummary::all_factor()\n✖ recipes::all_integer() masks gtsummary::all_integer()\n✖ recipes::all_logical() masks gtsummary::all_logical()\n✖ recipes::all_numeric() masks gtsummary::all_numeric()\n✖ gridExtra::combine()   masks dplyr::combine()\n✖ purrr::discard()       masks scales::discard()\n✖ dplyr::filter()        masks mice::filter(), stats::filter()\n✖ dplyr::group_rows()    masks kableExtra::group_rows()\n✖ dplyr::lag()           masks stats::lag()\n✖ yardstick::mae()       masks performance::mae()\n✖ yardstick::rmse()      masks performance::rmse()\n✖ recipes::step()        masks stats::step()\n• Search for functions across packages at https://www.tidymodels.org/find/\n```\n:::\n\n```{.r .cell-code}\nbns_imputed_mids <- readRDS(here::here(\"clean_data/imp_bns_combined_clean_mids.RData\"))\n\nbns_combined_imputed_df <- complete(bns_imputed_mids, fill = 3)\n\nload(\"clean_data/bns_combined.Rdata\")\n\nchc.palette <- c(\"#B1D238\", \"#5782B0\", \"#FF914D\")\n```\n:::\n\n\n\n\n\n> Values are based on Non exponentiated Betas\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbns_imputed_mids_sw <- bns_imputed_mids %>% filter(Cohort == \"Statewide\")\n\n\nbns_imputed_mids_sw2 <- bns_imputed_mids %>% filter(Cohort == \"Statewide\",\n                                                   school2 == \"CSU\",\n                                                   academic_level == \"Junior\" | academic_level == \"Senior\")\n\n\nbns_imputed_mids_p2 <- bns_imputed_mids %>% filter(Cohort == \"Pilot 2\")\n```\n:::\n\n\n\n## Fast Food Ordinal\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nff.ordinal.mod.p2 <- with(bns_imputed_mids_p2, MASS::polr(ff_cat~SNAP3 + gender + race_eth + age + physical_activity + storage_room + health_conscious + living_with_family + cooking_confident + food_insecure_2item + paid_work_hours_tens + homelessness_year, Hess=TRUE))\n\nff.ordinal.mod.sw <- with(bns_imputed_mids_sw, MASS::polr(ff_cat~SNAP3 + gender + race_eth + age + physical_activity + storage_room + health_conscious + living_with_family + cooking_confident + food_insecure_2item + paid_work_hours_tens + homelessness_year, Hess=TRUE))\n\nff.ordinal.mod.sw2 <- with(bns_imputed_mids_sw2, MASS::polr(ff_cat~SNAP3 + gender + race_eth + age + physical_activity + storage_room + health_conscious + living_with_family + cooking_confident + food_insecure_2item + paid_work_hours_tens + homelessness_year, Hess=TRUE))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nff.ordinal.mod.p2.tidy <- pool(ff.ordinal.mod.p2) |> summary() %>%\n  mutate(model = \"Pilot 2 Only\") %>% select(-df)\n\nff.ordinal.mod.sw.tidy <- pool(ff.ordinal.mod.sw) |> summary() %>%\n  mutate(model = \"Statewide Only\") %>% select(-df)\n\nff.ordinal.mod.sw2.tidy <- pool(ff.ordinal.mod.sw2) |> summary() %>%\n  mutate(model = \"Statewide CSU/Juniors and Seniors\") %>% select(-df)\n\n\nff_models <- bind_rows(ff.ordinal.mod.p2.tidy, ff.ordinal.mod.sw.tidy, ff.ordinal.mod.sw2.tidy)\n\ndwplot(ff_models) + geom_vline(xintercept = 0,\n               colour = \"black\",\n               linetype = 1) + xlab(\"Beta and SE\") + \n  theme(legend.position='top')  + guides(color = guide_legend(title = \"\"))\n```\n\n::: {.cell-output-display}\n![](Statewide-and-Pilot-2-Comparison_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n## SSB Ordinal\n\n\n::: {.cell}\n\n```{.r .cell-code}\nssb.ordinal.mod.p2 <- with(bns_imputed_mids_p2, MASS::polr(ssb_cat~SNAP3 + race_eth + gender + age + units_four + unpaid_work_hours_tens + paid_work_hours_tens + caregiving_hours_tens + health_conscious + storage_access + physical_activity + homelessness_year, Hess=TRUE))\n\nssb.ordinal.mod.sw <- with(bns_imputed_mids_sw, MASS::polr(ssb_cat~SNAP3 + race_eth + gender + age + units_four + unpaid_work_hours_tens + paid_work_hours_tens + caregiving_hours_tens + health_conscious + storage_access + physical_activity + homelessness_year, Hess=TRUE))\n\n\nssb.ordinal.mod.sw2 <- with(bns_imputed_mids_sw2, MASS::polr(ssb_cat~SNAP3 + race_eth + gender + age + units_four + unpaid_work_hours_tens + paid_work_hours_tens + caregiving_hours_tens + health_conscious + storage_access + physical_activity + homelessness_year, Hess=TRUE))\n\n\n# tbl_merge(tbls = list(ssb.ordinal.mod, ssb.ordinal.mod.p2, ssb.ordinal.mod.sw, ssb.ordinal.mod.sw2), tab_spanner = c(\"**Statewide  & Pilot 2**\", \"**Pilot 2 Only**\", \"**Statewide Data Only**\", \"**Statewide Data Only (CSU, Juniors, and Seniors only)**\"))\n# \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nssb.ordinal.mod.p2.tidy <- pool(ssb.ordinal.mod.p2) |> summary() %>%\n  mutate(model = \"Pilot 2 Only\") %>% select(-df)\n\nssb.ordinal.mod.sw.tidy <- pool(ssb.ordinal.mod.sw) |> summary() %>%\n  mutate(model = \"Statewide Only\") %>% select(-df)\n\nssb.ordinal.mod.sw2.tidy <- pool(ssb.ordinal.mod.sw2) |> summary() %>%\n  mutate(model = \"Statewide CSU/Juniors and Seniors\") %>% select(-df)\n\n\nssb_models <- bind_rows(ssb.ordinal.mod.p2.tidy, ssb.ordinal.mod.sw.tidy, ssb.ordinal.mod.sw2.tidy)\n\ndwplot(ssb_models) + geom_vline(xintercept = 0,\n               colour = \"black\",\n               linetype = 1) + xlab(\"Beta and SE\") + \n  theme(legend.position='top') + guides(color = guide_legend(title = \"\"))\n```\n\n::: {.cell-output-display}\n![](Statewide-and-Pilot-2-Comparison_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n## F&V Ordinal\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFV.ordinal.mod.p2 <- with(bns_imputed_mids_p2, MASS::polr(fruits3~SNAP3 + gender + race_eth + age  + health_conscious + cooking_confident + physical_activity + storage_room + food_insecure_2item + firstgen, Hess=TRUE))\n\nFV.ordinal.mod.sw <- with(bns_imputed_mids_sw, MASS::polr(fruits3~SNAP3 + gender + race_eth + age  + health_conscious + cooking_confident + physical_activity + storage_room + food_insecure_2item + firstgen, Hess=TRUE))\n\nFV.ordinal.mod.sw2 <- with(bns_imputed_mids_sw2, MASS::polr(fruits3~SNAP3 + gender + race_eth + age  + health_conscious + cooking_confident + physical_activity + storage_room + food_insecure_2item + firstgen, Hess=TRUE))\n\n\n\n# tbl_merge(tbls = list(FV.ordinal.mod, FV.ordinal.mod.p2, FV.ordinal.mod.sw, FV.ordinal.mod.sw2), tab_spanner = c(\"**Statewide & Pilot 2**\", \"**Pilot 2 Only**\", \"**Statewide Data Only**\",  \"**Statewide Data Only (CSU, Juniors, and Seniors only)**\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nFV.ordinal.mod.p2.tidy <- pool(FV.ordinal.mod.p2) |> summary() %>%\n  mutate(model = \"Pilot 2 Only\",\n         estimate = exp(estimate),\n         std.error = exp(std.error)) %>% select(-df)\n\nFV.ordinal.mod.sw.tidy <- pool(FV.ordinal.mod.sw) |> summary() %>%\n  mutate(model = \"Statewide Only\") %>% select(-df)\n\nFV.ordinal.mod.sw2.tidy <- pool(FV.ordinal.mod.sw2) |> summary() %>%\n  mutate(model = \"Statewide CSU/Juniors and Seniors\") %>% select(-df)\n\n\nFV_models <- bind_rows(FV.ordinal.mod.p2.tidy, FV.ordinal.mod.sw.tidy, FV.ordinal.mod.sw2.tidy)\n\ndwplot(FV_models) + geom_vline(xintercept = 0,\n               colour = \"black\",\n               linetype = 1) + xlab(\"Beta and SE\")  + \n  theme(legend.position='top') + guides(color = guide_legend(title = \"\"))\n```\n\n::: {.cell-output-display}\n![](Statewide-and-Pilot-2-Comparison_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Statewide-and-Pilot-2-Comparison_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}